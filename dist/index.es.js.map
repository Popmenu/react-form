{"version":3,"file":"index.es.js","sources":["../src/hooks/useAsyncDebounce.js","../src/hooks/useFormContext.js","../src/hooks/useFormElement.js","../src/utils.js","../src/hooks/useForm.js","../src/hooks/useFieldScope.js","../src/hooks/useField.js"],"sourcesContent":["import React from 'react'\n\nexport default function useAsyncDebounce(defaultFn, defaultWait = 0) {\n  const debounceRef = React.useRef({})\n  debounceRef.current.defaultFn = defaultFn\n  debounceRef.current.defaultWait = defaultWait\n\n  const debounce = React.useCallback(\n    async (\n      fn = debounceRef.current.defaultFn,\n      wait = debounceRef.current.defaultWait\n    ) => {\n      if (!debounceRef.current.promise) {\n        debounceRef.current.promise = new Promise((resolve, reject) => {\n          debounceRef.current.resolve = resolve\n          debounceRef.current.reject = reject\n        })\n      }\n\n      if (debounceRef.current.timeout) {\n        clearTimeout(debounceRef.current.timeout)\n      }\n\n      debounceRef.current.timeout = setTimeout(async () => {\n        delete debounceRef.current.timeout\n        try {\n          debounceRef.current.resolve(await fn())\n        } catch (err) {\n          debounceRef.current.reject(err)\n        } finally {\n          delete debounceRef.current.promise\n          delete debounceRef.current.resolve\n          delete debounceRef.current.reject\n        }\n      }, wait)\n\n      return debounceRef.current.promise\n    },\n    []\n  )\n\n  return debounce\n}\n","import React from 'react'\n//\n\nconst formContext = React.createContext()\n\nexport function FormContextProvider({ value, children }) {\n  return <formContext.Provider value={value}>{children}</formContext.Provider>\n}\n\nexport default function useFormContext(manualFormContext) {\n  let formApi = React.useContext(formContext)\n\n  if (manualFormContext) {\n    return manualFormContext\n  }\n\n  if (!formApi) {\n    throw new Error(`You are trying to use the form API outside of a form!`)\n  }\n\n  return formApi\n}\n","import React from 'react'\n//\n\nimport { FormContextProvider } from './useFormContext'\n\nexport default function useFormElement(contextValue) {\n  const FormRef = React.useRef()\n  const FormApiRef = React.useRef()\n\n  FormApiRef.current = contextValue\n\n  // Create a new form element\n  if (!FormRef.current) {\n    FormRef.current = function Form({ children, noFormElement, ...rest }) {\n      const {\n        handleSubmit,\n        meta: { isSubmitting },\n        debugForm,\n      } = FormApiRef.current\n\n      return (\n        <FormContextProvider value={FormApiRef.current}>\n          {noFormElement ? (\n            children\n          ) : (\n            <form onSubmit={handleSubmit} disabled={isSubmitting} {...rest}>\n              {children}\n              {debugForm ? (\n                <div\n                  style={{\n                    margin: '2rem 0',\n                  }}\n                >\n                  <div\n                    style={{\n                      fontWeight: 'bolder',\n                    }}\n                  >\n                    Form State\n                  </div>\n                  <pre>\n                    <code>\n                      {JSON.stringify(\n                        { ...FormApiRef.current, formContext: undefined },\n                        safeStringifyReplace(new Set()),\n                        2\n                      )}\n                    </code>\n                  </pre>\n                </div>\n              ) : null}\n            </form>\n          )}\n        </FormContextProvider>\n      )\n    }\n  }\n\n  // Return the form element\n  return FormRef.current\n}\n\nfunction safeStringifyReplace(set) {\n  return (key, value) => {\n    if (typeof value === 'object' || Array.isArray(value)) {\n      if (set.has(value)) {\n        return '(circular value)'\n      }\n      set.add(value)\n    }\n    return typeof value === 'function' ? undefined : value\n  }\n}\n","export function splitFormProps({\n  field,\n  defaultValue,\n  defaultIsTouched,\n  defaultError,\n  defaultMeta,\n  validatePristine,\n  validate,\n  onSubmit,\n  defaultValues,\n  filterValue,\n  debugForm,\n  ...rest\n}) {\n  return [\n    field,\n    {\n      defaultValue,\n      defaultIsTouched,\n      defaultError,\n      defaultMeta,\n      validatePristine,\n      validate,\n      onSubmit,\n      defaultValues,\n      filterValue,\n      debugForm,\n    },\n    rest,\n  ]\n}\n\n// Utils\n\nexport function getBy(obj, path) {\n  if (!path) {\n    throw new Error('A path string is required to use getBy')\n  }\n  const pathArray = makePathArray(path)\n  const pathObj = pathArray\n  return pathObj.reduce((current, pathPart) => {\n    if (typeof current !== 'undefined') {\n      return current[pathPart]\n    }\n    return undefined\n  }, obj)\n}\n\nexport function setBy(obj, path, updater) {\n  path = makePathArray(path)\n\n  function doSet(parent) {\n    if (!path.length) {\n      return typeof updater === 'function' ? updater(parent) : updater\n    }\n\n    const key = path.shift()\n\n    if (typeof key === 'string') {\n      if (typeof parent === 'object') {\n        return {\n          ...parent,\n          [key]: doSet(parent[key]),\n        }\n      }\n      return {\n        [key]: doSet(),\n      }\n    }\n\n    if (typeof key === 'number') {\n      if (Array.isArray(parent)) {\n        const prefix = parent.slice(0, key)\n        return [\n          ...(prefix.length ? prefix : new Array(key)),\n          doSet(parent[key]),\n          ...parent.slice(key + 1),\n        ]\n      }\n      return [...new Array(key), doSet()]\n    }\n\n    throw new Error('Uh oh!')\n  }\n\n  return doSet(obj)\n}\n\nexport function getFieldID(str) {\n  return makePathArray(str).join('_')\n}\n\nconst reFindNumbers0 = /^(\\d*)$/gm\nconst reFindNumbers1 = /\\.(\\d*)\\./gm\nconst reFindNumbers2 = /^(\\d*)\\./gm\nconst reFindNumbers3 = /\\.(\\d*$)/gm\nconst reFindMultiplePeriods = /\\.{2,}/gm\n\nfunction makePathArray(str) {\n  return str\n    .replace('[', '.')\n    .replace(']', '')\n    .replace(reFindNumbers0, '__int__$1')\n    .replace(reFindNumbers1, '.__int__$1.')\n    .replace(reFindNumbers2, '__int__$1.')\n    .replace(reFindNumbers3, '.__int__$1')\n    .replace(reFindMultiplePeriods, '.')\n    .split('.')\n    .map(d => {\n      if (d.indexOf('__int__') === 0) {\n        return parseInt(d.substring('__int__'.length), 10)\n      }\n      return d\n    })\n}\n\nfunction loopObject(obj, fn, callback) {\n  Object.keys(obj).forEach(key => {\n    callback(fn(obj[key], key), key)\n  })\n}\n\nexport function someObject(obj, fn) {\n  let found = false\n\n  loopObject(obj, fn, (result, key) => {\n    if (found) {\n      return\n    }\n    if (result) {\n      found = true\n    }\n  })\n\n  return found\n}\n","import React from 'react'\n//\nimport useAsyncDebounce from './useAsyncDebounce'\nimport useFormElement from './useFormElement'\nimport { someObject, getBy, setBy, getFieldID } from '../utils'\n\nconst defaultDefaultValue = {}\n\nfunction makeState(decor) {\n  return {\n    meta: {\n      isSubmitting: false,\n      isTouched: false,\n      isSubmitted: false,\n      submissionAttempts: 0,\n    },\n    __fieldMeta: {},\n    ...decor,\n  }\n}\n\nexport default function useForm({\n  onSubmit,\n  defaultValues = defaultDefaultValue,\n  validate,\n  validatePristine,\n  debugForm,\n} = {}) {\n  let [{ values, meta, __fieldMeta }, setState] = React.useState(() =>\n    makeState({\n      values: defaultValues,\n    })\n  )\n\n  const [shouldResubmit, setShouldResubmit] = React.useState(false)\n  const apiRef = React.useRef()\n  const metaRef = React.useRef({})\n  const __fieldMetaRefsRef = React.useRef({})\n\n  // Keep validate up to date with the latest version\n  metaRef.current.validate = validate\n\n  const fieldsAreValidating = someObject(\n    __fieldMeta,\n    field => field && field.isValidating\n  )\n  const fieldsAreValid = !someObject(__fieldMeta, field => field && field.error)\n\n  // Can we submit this form?\n  const isValid = !fieldsAreValidating && fieldsAreValid && !meta.error\n\n  const canSubmit = isValid && !meta.isValidating && !meta.isSubmitting\n\n  // Decorate form meta\n  meta = React.useMemo(\n    () => ({\n      ...meta,\n      fieldsAreValidating,\n      fieldsAreValid,\n      isValid,\n      canSubmit,\n    }),\n    [meta, fieldsAreValidating, fieldsAreValid, isValid, canSubmit]\n  )\n\n  // We want the apiRef to change every time state updates\n  const api = React.useMemo(\n    () => ({\n      values,\n      meta,\n      __fieldMeta,\n      debugForm,\n    }),\n    [debugForm, __fieldMeta, meta, values]\n  )\n  // Keep the apiRef up to date with the latest version of the api\n  apiRef.current = api\n\n  const reset = React.useCallback(() => {\n    setState(() =>\n      makeState({\n        values: defaultValues,\n      })\n    )\n  }, [defaultValues, setState])\n\n  // On submit\n  const handleSubmit = React.useCallback(async (e = {}) => {\n    if (e.persist) e.persist()\n    if (e.preventDefault) e.preventDefault()\n\n    // This lets sub-forms with form elements (despite them being invalid HTML)\n    // handle submissions without triggering parent forms\n    if (e.__handled) {\n      return\n    }\n    e.__handled = true\n\n    for (let retries = 0; retries < 10; retries += 1) {\n      if (apiRef.current.meta.fieldsAreValidating || apiRef.current.meta.isValidating) {\n        await new Promise(resolve => setTimeout(resolve, 100));\n      }\n    }\n\n    // Don't let invalid forms submit\n    if (!apiRef.current.meta.isValid) {\n      // If the form can't submit, let's trigger all of the fields\n      // to be touched. Thus, their validations will run\n      apiRef.current.setMeta({ isSubmitting: false })\n      return\n    }\n\n    apiRef.current.setMeta({ isSubmitting: true })\n\n    let needsResubmit = false\n\n    const fieldValidationPromises = []\n\n    Object.keys(apiRef.current.__fieldMetaRefs).forEach(key => {\n      const { current: fieldMeta } = apiRef.current.__fieldMetaRefs[key]\n      Object.keys(fieldMeta.instanceRefs).forEach(key => {\n        const { current: fieldInstance } = fieldMeta.instanceRefs[key]\n        // If any fields are not touched\n        if (!fieldInstance.meta.isTouched) {\n          // Mark them as touched\n          fieldInstance.setMeta({ isTouched: true })\n          // Likewise, if they need validation\n          if (fieldInstance.__validate) {\n            // Run their validation and keep track of the\n            // promise\n            fieldValidationPromises.push(fieldInstance.runValidation())\n          }\n        }\n      })\n    })\n\n    // If any validation needed to be run\n    if (fieldValidationPromises.length) {\n      // Mark for resubmission\n      needsResubmit = true\n    }\n\n    if (!apiRef.current.meta.isTouched) {\n      // Mark for resubmission\n      needsResubmit = true\n\n      // Mark the form as touched\n      apiRef.current.setMeta(old => ({\n        ...old,\n        isTouched: true,\n      }))\n    }\n\n    if (needsResubmit) {\n      // Wait for any field validations to complete\n      await Promise.all(fieldValidationPromises)\n      // Be sure to run validation for the form\n      // and wait for it to complete\n      await apiRef.current.runValidation()\n      // Then rerun the submission attempt\n      e.__handled = false\n      setShouldResubmit(e || true)\n      // Do not continue\n      return\n    }\n\n    apiRef.current.setMeta(old => ({\n      ...old,\n      // Submittion attempts mark the form as not submitted\n      isSubmitted: false,\n      // Count submission attempts\n      submissionAttempts: old.submissionAttempts + 1,\n    }))\n\n    try {\n      // Run the submit code\n      await apiRef.current.onSubmit(apiRef.current.values, apiRef.current)\n\n      apiRef.current.setMeta({ isSubmitted: true })\n    } catch (err) {\n      throw err\n    } finally {\n      apiRef.current.setMeta({ isSubmitting: false })\n    }\n  }, [])\n\n  // Create a debounce for this field hook instance (not all instances)\n  const debounce = useAsyncDebounce()\n\n  const setMeta = React.useCallback(\n    updater => {\n      setState(old => ({\n        ...old,\n        meta:\n          typeof updater === 'function'\n            ? updater(old.meta)\n            : { ...old.meta, ...updater },\n      }))\n    },\n    [setState]\n  )\n\n  const runValidation = React.useCallback(() => {\n    if (!metaRef.current.validate) {\n      return\n    }\n    apiRef.current.setMeta({ isValidating: true })\n\n    // Use the validationCount for all field instances to\n    // track freshness of the validation\n    const id = (metaRef.current.validationCount || 0) + 1\n    metaRef.current.validationCount = id\n\n    const checkLatest = () => id === metaRef.current.validationCount\n\n    if (!metaRef.current.validationPromise) {\n      metaRef.current.validationPromise = new Promise((resolve, reject) => {\n        metaRef.current.validationResolve = resolve\n        metaRef.current.validationReject = reject\n      })\n    }\n\n    const doValidation = async () => {\n      try {\n        // A bug fix when updating to React18: setMeta will not cause rerendering until the current JS task is finished\n        await new Promise(resolve => setTimeout(resolve, 0));\n\n        const error = await metaRef.current.validate(\n          apiRef.current.values,\n          apiRef.current\n        )\n\n        if (checkLatest()) {\n          apiRef.current.setMeta({ isValidating: false })\n          if (typeof error !== 'undefined') {\n            if (error) {\n              if (typeof error === 'string') {\n                apiRef.current.setMeta({ error })\n              }\n            } else {\n              apiRef.current.setMeta({ error: null })\n            }\n          }\n          metaRef.current.validationResolve()\n        }\n      } catch (err) {\n        if (checkLatest()) {\n          metaRef.current.validationReject(err)\n        }\n      } finally {\n        delete metaRef.current.validationPromise\n      }\n    }\n\n    doValidation()\n\n    return metaRef.current.validationPromise\n  }, [])\n\n  const getFieldValue = React.useCallback(\n    field => getBy(apiRef.current.values, field),\n    []\n  )\n\n  const getFieldMeta = React.useCallback(field => {\n    const fieldID = getFieldID(field)\n    return apiRef.current.__fieldMeta[fieldID]\n  }, [])\n\n  const __getFieldMetaRef = React.useCallback(field => {\n    const fieldID = getFieldID(field)\n    if (!apiRef.current.__fieldMetaRefs[fieldID]) {\n      apiRef.current.__fieldMetaRefs[fieldID] = {\n        current: {\n          instanceRefs: {},\n        },\n      }\n    }\n    return apiRef.current.__fieldMetaRefs[fieldID]\n  }, [])\n\n  const setFieldMeta = React.useCallback(\n    (field, updater) => {\n      const fieldID = getFieldID(field)\n      setState(old => {\n        const newFieldMeta =\n          typeof updater === 'function'\n            ? updater(old.__fieldMeta[fieldID])\n            : { ...old.__fieldMeta[fieldID], ...updater }\n\n        return {\n          ...old,\n          // Any errors in fields should visually stop\n          // form.isSubmitting\n          meta:\n            newFieldMeta && newFieldMeta.error\n              ? {\n                  ...old.meta,\n                  isSubmitting: false,\n                }\n              : old.meta,\n          __fieldMeta: {\n            ...old.__fieldMeta,\n            [fieldID]: newFieldMeta,\n          },\n        }\n      })\n    },\n    [setState]\n  )\n\n  const setFieldValue = React.useCallback(\n    (field, updater, { isTouched = true } = {}) => {\n      const fieldInstances = apiRef.current.__getFieldInstances(field)\n\n      setState(old => {\n        let newValue =\n          typeof updater === 'function'\n            ? updater(getBy(old.values, field))\n            : updater\n\n        fieldInstances.forEach(instance => {\n          if (instance.current.__filterValue) {\n            newValue = instance.current.__filterValue(newValue, apiRef.current)\n          }\n        })\n\n        return {\n          ...old,\n          values: setBy(old.values, field, newValue),\n        }\n      })\n      if (isTouched) {\n        apiRef.current.setFieldMeta(field, {\n          isTouched: true,\n        })\n        apiRef.current.setMeta({ isTouched: true })\n      }\n    },\n    [setState]\n  )\n\n  const __getFieldInstances = React.useCallback(field => {\n    const __metaRef = apiRef.current.__getFieldMetaRef(field)\n    return Object.keys(__metaRef.current.instanceRefs).map(\n      key => __metaRef.current.instanceRefs[key]\n    )\n  }, [])\n\n  const pushFieldValue = React.useCallback((field, value, options) => {\n    apiRef.current.setFieldValue(\n      field,\n      old => {\n        return [...(Array.isArray(old) ? old : []), value]\n      },\n      options\n    )\n  }, [])\n\n  const insertFieldValue = React.useCallback((field, index, value, options) => {\n    apiRef.current.setFieldValue(\n      field,\n      old => {\n        if (Array.isArray(old)) {\n          return old.map((d, i) => (i === index ? value : d))\n        } else {\n          throw Error(\n            `Cannot insert a field value into a non-array field. Check that this field's existing value is an array: ${field}.`\n          )\n        }\n      },\n      options\n    )\n  }, [])\n\n  const removeFieldValue = React.useCallback((field, index, options) => {\n    apiRef.current.setFieldValue(\n      field,\n      old => {\n        if (Array.isArray(old)) {\n          return old.filter((d, i) => i !== index)\n        } else {\n          throw Error(\n            `Cannot remove a field value from a non-array field. Check that this field's existing value is an array: ${field}.`\n          )\n        }\n      },\n      options\n    )\n  }, [])\n\n  const swapFieldValues = React.useCallback(\n    (path, index1, index2) => {\n      setState(old => {\n        const old1 = getBy(old.values, [path, index1])\n        const old2 = getBy(old.values, [path, index2])\n\n        let values = setBy(old.values, [path, index1], old2)\n        values = setBy(values, [path, index2], old1)\n\n        return {\n          ...old,\n          values,\n        }\n      })\n    },\n    [setState]\n  )\n\n  const setValues = React.useCallback(\n    values => {\n      setState(old => ({\n        ...old,\n        values: values,\n      }))\n    },\n    [setState]\n  )\n\n  // Create the Form element if necessary\n  const Form = useFormElement(api)\n\n  Object.assign(api, {\n    __fieldMetaRefs: __fieldMetaRefsRef.current,\n    onSubmit,\n    reset,\n    handleSubmit,\n    debounce,\n    setMeta,\n    runValidation,\n    getFieldValue,\n    getFieldMeta,\n    __getFieldMetaRef,\n    setFieldMeta,\n    setFieldValue,\n    __getFieldInstances,\n    pushFieldValue,\n    insertFieldValue,\n    removeFieldValue,\n    swapFieldValues,\n    setValues,\n    Form,\n    formContext: api,\n  })\n\n  // If shouldResubmit is true, do yo thang\n  React.useEffect(() => {\n    if (shouldResubmit) {\n      handleSubmit(shouldResubmit)\n      setShouldResubmit(false)\n    }\n  }, [handleSubmit, shouldResubmit])\n\n  // When the form gets dirty and when the value changes\n  // validate\n  React.useEffect(() => {\n    if (!validatePristine && !meta.isTouched) {\n      return\n    }\n\n    apiRef.current.runValidation(values)\n  }, [meta.isTouched, validatePristine, values])\n\n  // When defaultValues update, set them\n  React.useEffect(() => {\n    if (defaultValues !== apiRef.current.values) {\n      setState(old => ({\n        ...old,\n        values: defaultValues,\n      }))\n    }\n  }, [defaultValues, setState])\n\n  // Return the root form and the Form component to the hook user\n  return apiRef.current\n}\n","import React from 'react'\n//\n\nimport { FormContextProvider } from './useFormContext'\n\nexport default function useFieldScope(contextValue) {\n  const FieldScopeRef = React.useRef()\n  const FieldScopeApiRef = React.useRef()\n\n  FieldScopeApiRef.current = contextValue\n\n  // Create a new form element\n  if (!FieldScopeRef.current) {\n    FieldScopeRef.current = function Field({ children }) {\n      return (\n        <FormContextProvider value={FieldScopeApiRef.current}>\n          {children}\n        </FormContextProvider>\n      )\n    }\n  }\n\n  return FieldScopeRef.current\n}\n","import React from 'react'\n//\nimport useAsyncDebounce from './useAsyncDebounce'\nimport useFormContext from './useFormContext'\nimport useFieldScope from './useFieldScope'\nimport { getFieldID } from '../utils'\n\nlet uid = 0\n\nconst methodMap = [\n  'setFieldValue',\n  'setFieldMeta',\n  'pushFieldValue',\n  'insertFieldValue',\n  'removeFieldValue',\n  'swapFieldValues',\n]\n\nconst defaultDefaultMeta = {\n  error: null,\n  isTouched: false,\n  isValidating: false,\n}\n\nexport default function useField(\n  fieldName,\n  {\n    defaultValue,\n    defaultIsTouched = false,\n    defaultError = null,\n    defaultMeta = defaultDefaultMeta,\n    validatePristine,\n    validate,\n    filterValue,\n    formContext: manualFormContext,\n  } = {}\n) {\n  if (!fieldName) {\n    throw new Error(\n      `useField: A field is required to use this hook. eg, useField('myField', options)`\n    )\n  }\n\n  const formApiRef = React.useRef()\n  const fieldApiRef = React.useRef({})\n\n  let formApi = useFormContext(manualFormContext)\n\n  const instanceIDRef = React.useRef(uid++)\n  const instanceID = instanceIDRef.current\n\n  // Support field prefixing from FieldScope\n  let fieldPrefix = ''\n  if (formApi.fieldName) {\n    fieldPrefix = `${formApi.fieldName}.`\n    formApi = formApi.form\n  }\n  fieldName = fieldPrefix + fieldName\n\n  // Create a debounce for this field hook instance (not all instances)\n  const debounce = useAsyncDebounce()\n\n  // An escape hatch for accessing latest formAPI\n  formApiRef.current = formApi\n\n  // Get the field value, meta, and metaRef\n  const preValue = formApi.getFieldValue(fieldName)\n  const preMeta = formApi.getFieldMeta(fieldName)\n  const __metaRef = formApi.__getFieldMetaRef(fieldName)\n\n  // Handle default value\n  const value = React.useMemo(\n    () =>\n      typeof preValue === 'undefined' && typeof defaultValue !== 'undefined'\n        ? defaultValue\n        : preValue,\n    [defaultValue, preValue]\n  )\n\n  // Handle default meta\n  const meta = React.useMemo(\n    () =>\n      typeof preMeta === 'undefined'\n        ? {\n            ...defaultMeta,\n            error: defaultError,\n            isTouched: defaultIsTouched,\n          }\n        : preMeta,\n    [defaultError, defaultMeta, defaultIsTouched, preMeta]\n  )\n\n  // Create the fieldApi\n  const fieldApi = React.useMemo(\n    () => ({\n      value,\n      meta,\n      form: formApi,\n      fieldName,\n    }),\n    [fieldName, formApi, meta, value]\n  )\n\n  // Keep the fieldApiRef up to date\n  fieldApiRef.current = fieldApi\n  fieldApiRef.current.__filterValue = filterValue\n  fieldApiRef.current.__validate = validate\n\n  // Let's scope some field-level methods for convenience\n  const [\n    setValue,\n    setMeta,\n    pushValue,\n    insertValue,\n    removeValue,\n    swapValues,\n  ] = methodMap.map(d => {\n    // Since this array is stable and always the same, we can disable\n    // the react-hooks linter here:\n\n    // eslint-disable-next-line\n    return React.useCallback(\n      (...args) => formApiRef.current[d](fieldName, ...args),\n      // eslint-disable-next-line\n      [fieldName]\n    )\n  })\n\n  // Let's scope some field-level methods for convenience\n  const [\n    setFieldValue,\n    setFieldMeta,\n    pushFieldValue,\n    insertFieldValue,\n    removeFieldValue,\n    swapFieldValues,\n  ] = methodMap.map(d => {\n    // Since this array is stable and always the same, we can disable\n    // the react-hooks linter here:\n\n    // eslint-disable-next-line\n    return React.useCallback(\n      (subField, ...args) =>\n        formApiRef.current[d](`${fieldName}.${subField}`, ...args),\n      // eslint-disable-next-line\n      [fieldName]\n    )\n  })\n\n  const runValidation = React.useCallback(async () => {\n    if (!fieldApiRef.current.__validate) {\n      return\n    }\n    setMeta({ isValidating: true })\n\n    // Use the validationCount for all field instances to\n    // track freshness of the validation\n    const id = (__metaRef.current.validationCount || 0) + 1\n    __metaRef.current.validationCount = id\n\n    const checkLatest = () => id === __metaRef.current.validationCount\n\n    if (!__metaRef.current.validationPromise) {\n      __metaRef.current.validationPromise = new Promise((resolve, reject) => {\n        __metaRef.current.validationResolve = resolve\n        __metaRef.current.validationReject = reject\n      })\n    }\n\n    const doValidate = async () => {\n      try {\n        // A bug fix when updating to React18: setMeta will not cause rerendering until the current JS task is finished\n        await new Promise(resolve => setTimeout(resolve, 0));\n\n        const error = await fieldApiRef.current.__validate(\n          fieldApiRef.current.value,\n          fieldApiRef.current\n        )\n\n        if (checkLatest()) {\n          setMeta({ isValidating: false })\n          if (typeof error !== 'undefined') {\n            if (error) {\n              if (typeof error === 'string') {\n                setMeta({ error })\n              }\n            } else {\n              setMeta({ error: null })\n            }\n          }\n          __metaRef.current.validationResolve()\n        }\n      } catch (error) {\n        if (checkLatest()) {\n          __metaRef.current.validationReject(error)\n          throw error\n        }\n      } finally {\n        if (checkLatest()) {\n          setMeta({ isValidating: false })\n          delete __metaRef.current.validationPromise\n        }\n      }\n    }\n\n    doValidate()\n\n    return __metaRef.current.validationPromise\n  }, [__metaRef, setMeta])\n\n  const getInputProps = React.useCallback(\n    ({ onChange, onBlur, ...rest } = {}) => {\n      return {\n        value,\n        onChange: e => {\n          setValue(e.target.value)\n          if (onChange) {\n            onChange(e)\n          }\n        },\n        onBlur: e => {\n          setMeta({ isTouched: true })\n          if (onBlur) {\n            onBlur(e)\n          }\n        },\n        ...rest,\n      }\n    },\n    [setMeta, setValue, value]\n  )\n\n  const FieldScope = useFieldScope(fieldApi)\n\n  // Fill in the rest of the fieldApi\n  Object.assign(fieldApi, {\n    __metaRef,\n    setValue,\n    setMeta,\n    pushValue,\n    insertValue,\n    removeValue,\n    swapValues,\n    setFieldValue,\n    setFieldMeta,\n    pushFieldValue,\n    insertFieldValue,\n    removeFieldValue,\n    swapFieldValues,\n    debounce,\n    runValidation,\n    getInputProps,\n    FieldScope,\n  })\n\n  React.useEffect(() => {\n    const { current: meta } = formApiRef.current.__getFieldMetaRef(fieldName)\n\n    meta.instanceRefs = meta.instanceRefs || {}\n    meta.instanceRefs[instanceID] = fieldApiRef\n\n    const fieldID = getFieldID(fieldName)\n\n    return () => {\n      delete meta.instanceRefs[instanceID]\n      if (!Object.keys(meta.instanceRefs).length) {\n        fieldApiRef.current.setMeta(() => undefined)\n        delete formApiRef.current.__fieldMetaRefs[fieldID]\n      }\n    }\n  }, [fieldName, instanceID])\n\n  // The default value effect handler\n  React.useEffect(() => {\n    if (typeof preValue === 'undefined' && typeof value !== 'undefined') {\n      setValue(value, { isTouched: false })\n    }\n  }, [preValue, setValue, value])\n\n  // The default meta effect handler\n  React.useEffect(() => {\n    if (typeof preMeta === 'undefined' && typeof meta !== 'undefined') {\n      setMeta(meta)\n    }\n  }, [fieldName, meta, preMeta, setMeta, setValue, value])\n\n  // When the form gets dirty and when the value changes, run the validation\n  React.useEffect(() => {\n    setTimeout(()=> {\n      const isTouched = meta.isTouched || formApiRef.current.getFieldMeta(fieldName)?.isTouched\n      if (!validatePristine && !isTouched) {\n        return;\n      }\n\n      try {\n        runValidation(value);\n      } catch (err) {\n        console.error('An error occurred during validation', err);\n      }\n    }, 0)\n  }, [meta.isTouched, fieldName, runValidation, validatePristine, value])\n\n  return fieldApiRef.current\n}\n"],"names":["useAsyncDebounce","defaultFn","defaultWait","debounceRef","React","useRef","current","debounce","useCallback","fn","wait","promise","Promise","resolve","reject","timeout","clearTimeout","setTimeout","err","formContext","createContext","FormContextProvider","value","children","useFormContext","manualFormContext","formApi","useContext","Error","useFormElement","contextValue","FormRef","FormApiRef","Form","noFormElement","rest","handleSubmit","isSubmitting","meta","debugForm","margin","fontWeight","JSON","stringify","undefined","safeStringifyReplace","Set","set","key","Array","isArray","has","add","splitFormProps","field","defaultValue","defaultIsTouched","defaultError","defaultMeta","validatePristine","validate","onSubmit","defaultValues","filterValue","getBy","obj","path","pathArray","makePathArray","pathObj","reduce","pathPart","setBy","updater","doSet","parent","length","shift","prefix","slice","getFieldID","str","join","reFindNumbers0","reFindNumbers1","reFindNumbers2","reFindNumbers3","reFindMultiplePeriods","replace","split","map","d","indexOf","parseInt","substring","loopObject","callback","Object","keys","forEach","someObject","found","result","defaultDefaultValue","makeState","decor","isTouched","isSubmitted","submissionAttempts","__fieldMeta","useForm","useState","values","setState","shouldResubmit","setShouldResubmit","apiRef","metaRef","__fieldMetaRefsRef","fieldsAreValidating","isValidating","fieldsAreValid","error","isValid","canSubmit","useMemo","api","reset","e","persist","preventDefault","__handled","retries","setMeta","needsResubmit","fieldValidationPromises","__fieldMetaRefs","fieldMeta","instanceRefs","fieldInstance","__validate","push","runValidation","old","all","id","validationCount","checkLatest","validationPromise","validationResolve","validationReject","doValidation","getFieldValue","getFieldMeta","fieldID","__getFieldMetaRef","setFieldMeta","newFieldMeta","setFieldValue","fieldInstances","__getFieldInstances","newValue","instance","__filterValue","__metaRef","pushFieldValue","options","insertFieldValue","index","i","removeFieldValue","filter","swapFieldValues","index1","index2","old1","old2","setValues","assign","useEffect","useFieldScope","FieldScopeRef","FieldScopeApiRef","Field","uid","methodMap","defaultDefaultMeta","useField","fieldName","formApiRef","fieldApiRef","instanceIDRef","instanceID","fieldPrefix","form","preValue","preMeta","fieldApi","args","setValue","pushValue","insertValue","removeValue","swapValues","subField","doValidate","getInputProps","onChange","onBlur","target","FieldScope","console"],"mappings":"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"}